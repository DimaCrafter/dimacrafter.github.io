---
structure: {
    icon: 'folder-api',
    childs: [
        {
            icon: 'folder-controller',
            name: 'controllers',
            desc: 'Директория, содержащая контролеры',
            childs: [
                {
                    icon: 'javascript',
                    name: '<ControllerName>.js',
                    desc: 'Контроллер API для обработки запросов'
                }
            ]
        },
        {
            icon: 'folder-database',
            name: 'models',
            desc: 'Содержит модели данных для работы с БД',
            tag: 'Опционально',
            childs: [
                {
                    icon: 'database',
                    name: '<driver-name>',
                    desc: 'Идентификатор драйвера БД',
                    childs: [
                        {
                            icon: 'json',
                            name: '<ModelName>.js',
                            desc: 'Модель базы данных'
                        }
                    ]
                }
            ]
        },
        {
            icon: 'settings',
            name: 'config.json',
            desc: 'Конфигурационный файл'
        },
        {
            icon: 'javascript',
            name: 'startup.js',
            tag: 'Опционально',
            desc: 'Скрипт, выполняемый до запуска API сервера'
        },
    ]
}
---

# Введение

## Обычная установка

**0)** Сначала сгенерируйте `package.json`, выполнив `npm init` или `yarn init`.

**1)** Далее установите пакет, используя `npm i dc-api-core --save`
       или `yarn add dc-api-core`.
       Во время установки будет предложено глобально установить CLI, если отсутствует,
       и настроить проект в текущей директории
       (подробнее в [Установке через CLI](#установка-через-cli)).

**1.1)** Если во время установки Вы настроили проект при помощи CLI,
         то Вы уже можете запустить сервер,

**1.2)** Иначе Вам нужно вручную выполнить действия ниже.

**2)** Заполните `scripts` в `package.json`:

```json
"scripts": {
    "start": "dc-api-core",
    "dev": "dc-api-core --dev"
}
```

**3)** Создайте необходимые директории и файлы, указанные в разделе [Структура](#структура).

## Установка через CLI

Если у Вас есть глобально установленный CLI, то Вы можете перейти в директорию,
в которой будет настроен сервер, и выполнить `dc-api-cli init` или
`dc-api-cli init <path>` (где `<path>` - путь до нужной директории).

Пример хода установки:

<Terminal>
    [#50e3c2]$ dc-api-cli init[/#]
    Рабочая директория: /path/to/backend
    Введите порт: [#0fb1c5]8080[/#]

    Плагины:
    [#0fb1c5](используйте стрелочки для перемещения, пробел для выбора и enter для подтверждения)[/#]
    [#0ac484]x dc-api-mongo[/#]

    Выберите провайдера сессии:
    [#0fb1c5](используйте стрелочки для перемещения и enter для подтверждения)[/#]
      Без сессии
    [#0ac484]➔ dc-api-mongo[/#]
</Terminal>

## Структура

<Tree :data="$frontmatter.structure" />

## Конфигурационный файл

```json
{
    // Опционально
    "db": {
        // mongo - код драйвера dc-api-mongo (MongoDB)
        "mongo": {
            // Все поля зависят от драйвера, ниже указанны распространённые
            // Название базы данных, обязательное поле
            "name": "test_database",
            // Хост подключения, обязательное поле
            "host": "localhost",
            // Порт подключения, опционально
            "port": 27017,
            // Имя пользователя базы данных, опционально
            "user": "root",
            // Пароль пользователя, опционально
            "pass": "test-passwd"
        }
    },

    // Опционально, если отсутствует, то сессии будут недоступны
    "session": {
        // Строка, используемая для шифрования сессий, обязательное поле
        "secret": "some r@ndom str1ng",
        // Код драйвера базы данных, обязательное поле
        "store": "mongo",
        // Время жизни сессии в формате zeit/ms, опционально
        "ttl": "3d"
    },

    // Опционально, если отсутствует, то будет использован HTTP
    "ssl": {
        // Любое поле μWS.SSLApp, опционально
        "some_key": "value",
        // Абсолютный путь до SSL сертификата
        "cert": "/etc/letsencrypt/live/awesome.site/cert.pem",
        // Абсолютный путь до приватного SSL ключа
        "key": "/etc/letsencrypt/live/awesome.site/privkey.pem"
    },

    // Массив с названиями пакетов плагинов, опционально
    "plugins": ["dc-api-mongo"],
    // Принимать CORS только с этого домена, опционально
    "origin": "<Значение заголовка Origin>",
    // Порт, прослушиваемый API сервером, опционально
    "port": 8081,
    // Время подключения WebSocket в секундах, опционально
    "ws_timeout": 60,
    // Время жизни WebSocket соединения в секундах, опционально.
    // 0 - время подключения не ограничено
    "ttl": 0,
    // Директории, обновление которых не будет учитываться в режиме разработки, опционально
    "ignore": [],
    // Только для чтения, true, если включен режим разработки
    "isDev": "<Boolean>",

    // Объект, перезаписывающий конфиг в режиме разработки, опционально
    "dev": {
        // Перезаписывает значения ключей db.mongo.name и db.mongo.name
        "db": {
            "mongo": {
                "name": "dev_database",
                "pass": "dev-passwd"
            }
        },
    }
}
```
